/* iOS Safe Area Support for PWA */

/* CSS Custom Properties for Safe Area */
:root {
  /* Safe area insets - these are automatically set by iOS */
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
  
  /* Header height including safe area */
  --header-height: calc(3.5rem + var(--safe-area-inset-top)); /* 3.5rem = h-14 from header */
}

/* Apply safe area to html and body for full coverage */
html {
  /* Fill the entire viewport including notch area */
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height for better mobile support */
}

body {
  /* Ensure body takes full height and handles safe area */
  min-height: 100vh;
  min-height: 100dvh;
  /* Let components handle safe area individually for better control */
  padding: 0;
}

/* Reset body padding when not in PWA mode */
@media (display-mode: browser) {
  body {
    padding-top: 0;
    padding-left: 0;
    padding-right: 0;
    padding-bottom: 0;
  }
  
  :root {
    --header-height: 3.5rem; /* Just the header height without safe area */
  }
}

/* Header safe area styles */
.header-safe-area {
  /* Extend header into the safe area */
  padding-top: var(--safe-area-inset-top);
  margin-top: calc(-1 * var(--safe-area-inset-top));
}

/* Main content safe area adjustments */
.main-content-safe-area {
  /* Adjust main content for header height including safe area */
  padding-top: var(--header-height);
}

/* Layout-specific safe area utilities */
.layout-main-content {
  /* Main content area that accounts for header and safe areas */
  min-height: calc(100vh - var(--header-height) - var(--safe-area-inset-bottom));
  min-height: calc(100dvh - var(--header-height) - var(--safe-area-inset-bottom));
}

/* Content wrapper that avoids sidebar overlap */
@media (min-width: 1024px) {
  .layout-content-with-sidebar {
    /* Ensure content doesn't overlap with fixed sidebar on desktop */
    margin-left: 0;
    width: 100%;
  }
  
  /* Adjust header and main content for sidebar's safe area on desktop */
  .sidebar-aware-content {
    /* Account for additional space if sidebar has safe area padding */
    margin-left: calc(16rem + var(--safe-area-inset-left)); /* 16rem = w-64 */
    width: calc(100% - 16rem - var(--safe-area-inset-left));
  }
}

/* Utilities for safe area spacing */
.pt-safe-top {
  padding-top: var(--safe-area-inset-top);
}

.pb-safe-bottom {
  padding-bottom: var(--safe-area-inset-bottom);
}

.pl-safe-left {
  padding-left: var(--safe-area-inset-left);
}

.pr-safe-right {
  padding-right: var(--safe-area-inset-right);
}

/* Safe area margin utilities */
.mt-safe-top {
  margin-top: var(--safe-area-inset-top);
}

.mb-safe-bottom {
  margin-bottom: var(--safe-area-inset-bottom);
}

.ml-safe-left {
  margin-left: var(--safe-area-inset-left);
}

.mr-safe-right {
  margin-right: var(--safe-area-inset-right);
}

/* Full height utilities that respect safe area */
.h-screen-safe {
  height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  height: calc(100dvh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
}

.min-h-screen-safe {
  min-height: calc(100vh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
  min-height: calc(100dvh - var(--safe-area-inset-top) - var(--safe-area-inset-bottom));
}

/* PWA-specific styles */
@media (display-mode: standalone) {
  /* Hide any browser UI remnants in standalone mode */
  body {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
  }
  
  /* Allow text selection for inputs and content areas */
  input, textarea, [contenteditable], .selectable {
    -webkit-user-select: text;
    user-select: text;
  }
  
  /* Smooth scrolling for better native feel */
  * {
    -webkit-overflow-scrolling: touch;
  }
}

/* Debug helper - remove in production */
.debug-safe-area {
  border: 2px solid red;
  position: relative;
}

.debug-safe-area::before {
  content: 'Safe: ' attr(data-safe-area);
  position: absolute;
  top: 0;
  left: 0;
  background: red;
  color: white;
  padding: 2px 4px;
  font-size: 10px;
  z-index: 9999;
}